(ns advent-three)

(def input "....##..#........##...#.#..#.##\n.#.#..#....##....#...#..##.....\n##.#..##..#...#..........##.#..\n.#.##.####..#......###.........\n#.#.#...........#.....#...#....\n#.......#....#.#.##..###..##..#\n.#...#...##....#.........#.....\n..........##.#.#.....#....#.#..\n.......##..##...#.#.#...#......\n.#.#.#...#...##...#.##.##..#...\n........##.#.#.###.........##..\n#.#..#.#.#.....#...#...#......#\n.#.#.#...##......#...#.........\n.#..##.##.#...#...##....#.#....\n.##...#..#..#......##.###....##\n.....#...#.###.....#.#.........\n#.##..#....#.#.#.#.............\n........#...#......#...#..#....\n##..##...##.##...#...#.###...##\n#.#....##.#...###......#..#.#..\n..#.....#.##......#..........#.\n#.......#..#......#.....#....#.\n.....###...........#....#.##...\n#.#........##.......#.#...#.##.\n.#.#.#........#........#.#.....\n#..#..##.....#.###..#.#.#.##..#\n..#.#...#..##.#.#.#.......###..\n........#........#..#..#...#...\n##............#...#..##.##...#.\n#....#.#.....##...#............\n............#...#..#.#.#....#..\n#.#.#...##.##.#....#....#......\n................###.....#.....#\n##.#####.#..#...###..#...###...\n...#.....#...#.#....#...#..#...\n.......#....##.##.#.##.........\n..#..#..##.....#...#.#.....#...\n...#...#.#.##.#..###.......#...\n...#...........#.#####..##..#..\n#.#...#........####..#......#.#\n#..#.##...........#.#......#.##\n#.#..#....##..#..##.#..........\n.....#..#.....#........##..#...\n...###.......#.##.......#......\n...##..#..#...#....#.###...#...\n....####....#........#.##.#.#.#\n#....#.....#.###.##...##..##.##\n.##.#...#.##.#......#..##.#....\n...#.............#.............\n..##..##.#.....#........##....#\n#.....#....#.......####...#..#.\n..#...#..#...#...##.#....##....\n.#...##....#....#..#....#......\n##..#.#...##......#..#.......##\n..#...#.##..#.....#.#...#..#.#.\n#..##....#..........#..........\n.#........#..#......#......#.#.\n...##.#.........#.#....#.#...#.\n#.....#.#..#...#...#..#...#...#\n#.........#.#.........##.......\n.#.......#......#.........###..\n.#..#..##...........#.....#..#.\n.#....................#.....#..\n.##.....#....#....#.###.....#..\n...##.#.....#.#....#.........#.\n.........##.....#.....#.##..#..\n......#......#.#..#..###...#..#\n..##...#.#..#...#.#....#.......\n..#..##.###.#..#..#..#......#..\n.....##...##.........#...##...#\n###.#..##....##...##.#..###....\n#...#.#..##......##...#.#..#...\n..........#....###....#........\n#.#.#.#.#.....#..##.##.....#...\n.##.....#...#.....#......#.....\n.#..........#.#.............#..\n.#..##..#.#..##...#....#.##...#\n..#.#..........#...#..........#\n.#.......#.......#...#..#.....#\n##.#...##...#......#.#..#......\n#####..#....#..#...#...#.#.....\n....#.......#.#..#.............\n#..#..#.#.####...#....#....##..\n#..#.##.#......#...#......#....\n#...##.##...#....#..........##.\n..#..#.......##.#....#...#.#...\n.....#.##..............##.....#\n..##.##...##.....#.........#.#.\n.#....##...##...##..#....##..#.\n.#...#....#..#......#.#........\n#....#.#.#..............#....##\n..##..#..#....#####.#....#.#.##\n#....#...#.##..#.##.........###\n#..#..#....#...............#.#.\n#....##...##........##.##.#.##.\n......#......##....##.....#.###\n#...##..#..#.....#.#........##.\n..#.#.##...#...#....#..###...#.\n#..##..#.###..##.#.#....#......\n..###..#.##........###.....#...\n#.............#.............#..\n.#.##....#..##.#...#....#.#####\n###.....###.#......##..#..##...\n.#.#......##.#....#....#.#..#..\n###..#..#....#......###.##.....\n......#.......#......#..##..##.\n..#..#...#..#....#.##....#.#..#\n.......##..#........#.#.##.....\n.#...#..#........#..#.#..#..#.#\n.#..#.##.......#......#...#.#..\n.##..##......##.#...#......####\n.....#....#......#.....#......#\n..........#.#.#...##.#..#.#....\n...#.......##......#..#.#.##...\n.###..#.#.#....................\n##...#...#.##............#.....\n....#....#.##...#..#.#...##....\n..#.#....#.###...#...#.#.####.#\n..#..#.#...#.#......##.........\n#..#..####.##.#.#..###....#...#\n....#..........#.##.#..#.#.#.#.\n#.#.##.........#.....##...#..##\n#......#...#.##.#......#..#.#..\n#...#........#..#..#...##...#..\n.....#.####..##..#.#.##..#...#.\n#..#........#........#...#....#\n...........#..#.....#.#.#.#....\n....#......#....#...#....##....\n.#.#..#...#.#....#..#.#....##.#\n....#...#...#.##..#...#..##...#\n#######...............##.....##\n.#.#..............#....#..#.###\n#......#.#......###....###.....\n##..#...#.##..##..##.#....#....\n#....##..#..#...#.#.#...#......\n..........#..#.##..##.##.#..##.\n....#.#.#.....##........#..#...\n..###...#.....##.##.....##..##.\n....#.#..#.#.......#.......#...\n..##.#..#.....##...###...#...#.\n..#.........#...##...#...#..#..\n..#..#..#..#..##.#...##..#.#...\n...##..#..##..#..####...#.....#\n............#............###...\n.#.#.###.#.....#.#.#..#.###..#.\n...#.........#.....####........\n....##.#..##.#.............#...\n....#.##.....#..#.....#......##\n..........#.............#...##.\n#..#.....#.......##..###.......\n..##.#...........#.......#..#..\n...#...#.#.##.###....#.#..#....\n...#..........##..#..#..#...###\n.........#.....#..##.....#..#..\n#........#...#...#..#.#....##..\n.#.#.....####..#.##.#..........\n###.......##..#.##...#.....#...\n..###.##.#..#..#..#.....##...#.\n.........#.....##.#..#..##.....\n#..#..##...###..............#..\n#....#.#....#..#.....#..####...\n####..#.....##...#..#.#.#.#...#\n...#....#.....#.##.#.#.#....##.\n..........#...#.....###....#.##\n#....#.#.#....#..#..#.....#....\n.....#.#...#......#....#......#\n.####....##...#...#......##..#.\n.#...#..#....#..#..............\n##.#...##...#.##..#......#.....\n..####.##..#....#.#......#.#.##\n........#.....##...#.#..##....#\n....#.#.#.#.###...#.#...##...##\n#.....#...####.#....#.#........\n..#.....#...##.........###.....\n....#....#....#..#......#####.#\n###.....#..#.#.#......#.##.#...\n....#.##......#..#.#...........\n.#....#....#.#..#.......#...##.\n...................#.#.#..#....\n##...#.....#........#....#...#.\n........##......#...##.#..#.#.#\n#.#..###...#....#.#...#.......#\n#..........##......#..#..#.....\n.............#...##.#...#......\n#..#....##..#.........#..#.###.\n.....#..........#....##.#...##.\n###....................#.#.##..\n#........##...##......#....###.\n#....#.............#....#...#..\n##.......##.#.......#....#..#..\n##...#............#..#.#....##.\n..#.#..#...#####..........#....\n..#.........##.....#.#...####..\n....#..............#...........\n..#...#.#.#..#.......##.#.#.#..\n....#.##.....##..#.....#..####.\n#...#...#...#.......#.........#\n......#..#.####...###.#.#.....#\n.......#..#..#.....#.#..##.#..#\n.#......##..#............#.....\n.#........#.#....#....#........\n.....#.#..#.##.#..##....#..#...\n#.#...........#....##.....#....\n..#..#..##.###..##..#..###.#.##\n##.#..#...##.#.........#...#.#.\n......#..#..##...#....#...#.##.\n#.##.......................#...\n.......#..#..#.##..##......#...\n..#.#...#.....#..###....#...#..\n##..#.....#..#..#.##.....#...##\n#...##...###...#.#..###....#...\n...#.#.#..####.....#...##....#.\n.#.#..##.....#..#.....##..##..#\n#...#..........#.##.#.#........\n..##....#.##....#..##......#...\n....#..........###.....####..##\n...........###....##.#.#.#.#...\n...#......................####.\n#.#.#...#.#.#.#.#......#.....##\n..###...#.####...#..##..#....#.\n....#....#.......#...#.........\n.#.###.............##..#...#...\n....#.#....##...#.....#.##.....\n#.......##.....#.#.....#....##.\n....##.....###..#.#..#....#...#\n......#..##...#......#.....#.##\n.#.....#.##.###....#.....#..###\n...#..#.###.#....#..#..#...##.#\n...##..#...#..#.#.#..#...#.....\n##.####...##..#.#.#....#.......\n..##..#.#.......##.#......##.#.\n....##....#....#..#....#..##.#.\n..##..........##....#...#.#..#.\n#.#...#.#.###.#.#..##.#...#....\n.....#..#.............#...#...#\n....#.#..#...##...#....#.##....\n#..#...#.###.....#...#.....#.#.\n#####....#....#....#.......#.##\n#...##....##.#.#...#.....##.#..\n#.......#...#..#..#...#....#...\n....#......#.#..........#....##\n#.###...#.#..##..#.##........#.\n#..#.....##.......#..#..#.#....\n...#...#.##...#....#.#.#.#...#.\n...##..#.#....#......###......#\n#.#....#...#..#..#....#........\n..#..#.#...##..........#.###...\n#..........#...#..#....#....###\n..#..#.#....#..............#...\n...#........#...#.#....###.#..#\n....#.#.#................#..#.#\n..#........##.#....#.#..#......\n...##..#..#.......#..#......#.#\n..#..#....#.........#....#.##..\n#.....#....###.#..#..#...#...#.\n..#..##.###.#..##....#.###.....\n...#...####..#........###.#....\n.........#.#...#..#..#.#.......\n.##.........##.#..............#\n..#.#.#.....###........#.#.#..#\n....##..#....#....#.#..#.......\n#.#.....#...#........##........\n.##.#.#..#..#.#.#.........#....\n#.....#..#.##...#...#..........\n##..#....#....##.#..#.........#\n................#.##.#......#.#\n..#..#.#........##...###..#...#\n##........#.......#...##.##..#.\n##....#.....#..##....#.......#.\n#.#....#.#........#..#.........\n......##......#...#.....#.##...\n###....#..........##.#.#......#\n......#...###.........###..#...\n.####....#...##..#.#.....#...#.\n.##...#...###....#...#.#..###..\n#..#......##...#.###..###...#..\n#....#.#.#..#....##...#.##..#..\n..#.....#...#..........#.##.###\n#.....#....###.......##..##.#..\n#..##...#..#....#.###......#...\n#..#........##..#.....#.#.#....\n#.##.#.#..#....#.#.............\n.#...............#....##.......\n.#.##......##........#...#..#.#\n.#...#....#....#...#..#...##...\n.....#..###...##........#.#....\n...#.......#....##..#..#....#..\n...###....#........#..#.###.#..\n......##..##..............###.#\n.......#.####..##....#.#....#..\n#...#......#...#..#.....##....#\n.#..#..###....#..##.##.#.......\n#......##......#..##....#..##..\n.....#..#.#......##.##..##.....\n...#..#.......#......#.........\n....#..####......#..#....#...#.\n..#.#..#...#....#....#.......#.\n####..#........#.###...##.#.#.#\n.......##........#.#.#...##....\n...#.........#..#.#..##....#...\n.....#..#...#.#....#...#.#.##.#\n#..##.....#.....##.......#...#.\n.......##.#.#.....#....#......#\n...#...#.##...#......#....#....\n..#..#.#...#..#.....#...###.#..\n.........#...#..#.......##.....\n..##...................#..#.###\n.##.##..#.#...#.#....#.....##..\n#.#...##...#...#...##..#......#\n....#..#...#.....##.#.....#..##\n##.#..........###..#...#..#....\n...##....#.##....#......#......\n.....#.........#....#.#.......#\n.......#............#.#.....#..\n..#..#...#..#####..#....##.....\n...##......##...#.#........##..\n.....#..###...##.#.#.##.#...#..\n..#.#.#..##..#.##...##.#.#.....\n......##...#..##......#.#......\n......................#........\n#...#..#....#..#.#.##.#.....#.#\n.#......#.#....#.#.#..#....#...\n.#..#.#.#..#....#..............")


(defn parse-line [line]
  (mapv #(when (= \# %) true) line))

(defn clean-input [x]
  (->> (clojure.string/split x #"\n")
       (mapv parse-line)))

#_ (clean-input input)

(defn count-trees [rise run hill]
  (let [length (count hill)
        width (count (first hill))]
    (loop [x 0 y 0 trees 0]
      (if (<= length y)
        trees
        (let [is-tree (get-in hill [y (mod x width)])]
          (recur (+ x run) (+ y rise) (if is-tree (inc trees) trees)))))))


#_ (let [hill (clean-input input)
         slopes [[1 1] [1 3] [1 5] [1 7] [2 1]]
         counts (map (fn [[x y]] (count-trees x y hill)) slopes)]
     (apply * counts))

